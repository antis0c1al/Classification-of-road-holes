# Классификация дорожных ям

Оформление задачи находится в Classification-of-road-holes.ipynb

## Описание задачи
Разработка модели машинного обучения для классификации глубины дорожных ям на основе данных с датчиков карьерных самосвалов. Целевая переменная - `point` (глубина ямы).

## Описание данных
Основные используемые признаки:

| Признак                          | Описание                                      |
|----------------------------------|-----------------------------------------------|
| `len`                            | Пройденный путь (м)                           |
| `Скорость`                       | Скорость самосвала (км/ч)                     |
| `Широта`, `Долгота`, `Высота`    | Географические координаты                     |
| `X Rotation`, `Y Rotation`       | Показания гироскопа                           |
| `Вес мгновенный`                 | Текущий вес груза (тонны)                     |
| `Ускорение по осям X/Y/Z`        | Ускорение самосвала по осям                   |
| `Обороты двигателя`              | Обороты двигателя (об/мин)                    |
| `Расчетный выходной крутящий момент` | Крутящий момент двигателя (% от эталонного) |
| `Текущая нагрузка двигателя`     | Нагрузка двигателя (%)                        |
| `Продольный наклон`, `Поперечный наклон` | Углы наклона дороги                      |
| `point`                          | **Целевая переменная**: глубина ямы           |

**Примечание**: Признаки с названием "Давление" исключены из анализа согласно условию задачи.

## Методы решения

### Предобработка данных
1. Объединение 105 файлов в единый датасет
2. Удаление технических столбцов (`folder`, `border_lists`)
3. Преобразование категориальных признаков с помощью `LabelEncoder`
4. Удаление пустых столбцов

### Разделение данных
- **Train**: файлы `1_w.csv` - `84_w.csv` (80% данных)
- **Validation**: файлы `85_w.csv` - `105_w.csv` (20% данных)

### Feature Engineering
- Добавление признаков на основе UMAP (2D и 3D компоненты)
- Кластеризация HDBSCAN на основе 3D-компонент UMAP
- Генерация новых признаков через AutoML

### Модели и подходы
1. **`CatBoostClassifier`** (baseline)
2. **UMAP + CatBoost** (2D и 3D компоненты)
3. **HDBSCAN + UMAP + CatBoost**
4. **AutoML** (библиотека `supervised`)

## Результаты экспериментов

| Метод                                 | Accuracy  | Δ от baseline |
|---------------------------------------|----------|---------------|
| Baseline (CatBoost, 1500 итераций)    | 0.9404   | -             |
| UMAP 2D + компоненты как признаки     | 0.9397   | -0.0007       |
| UMAP 3D + компоненты как признаки     | 0.9409   | +0.0005       |
| HDBSCAN на 3D UMAP-компонентах        | 0.9419   | +0.0010       |
| **AutoML**                            | **0.9473**| **+0.0054**   |

## Итоговое решение
Лучший результат достигнут с использованием **AutoML**:
- Итоговый accuracy: **0.9473**
- Относительное улучшение: **+0.69%** по сравнению с baseline

### Ключевые особенности решения
- Использование `UMAP` для снижения размерности данных
- Применение `HDBSCAN` для выделения пространственных кластеров
- Автоматический подбор моделей и признаков через `AutoML`
- Разделение данных по источникам (файлам) для избежания информационной утечки
